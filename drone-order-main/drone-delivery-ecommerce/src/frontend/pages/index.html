<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DroneShop - Giao h√†ng b·∫±ng Drone</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <!-- Leaflet Routing Machine CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-drone"></i>
                <span>DroneShop</span>
            </div>
            
            <nav class="nav-menu">
                <ul>
                    <li><a href="#" onclick="showPage('home')" class="nav-link active" data-page="home">Trang ch·ªß</a></li>
                    <li><a href="#" onclick="showPage('products')" class="nav-link" data-page="products">S·∫£n ph·∫©m</a></li>
                    <li><a href="#" onclick="showPage('drones')" class="nav-link" data-page="drones">Drone</a></li>
                </ul>
            </nav>
            
            <div class="nav-auth" id="authButtons">
                <button class="btn-login" onclick="showLoginModal()">
                    <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
                </button>
                <button class="btn-register" onclick="showRegisterModal()">
                    <i class="fas fa-user-plus"></i> ƒêƒÉng k√Ω
                </button>
            </div>
            
            <div class="nav-user-menu" id="userDropdown" style="display: none;">
                <div class="dropdown">
                    <a href="#" class="dropbtn">
                        <i class="fas fa-user"></i> <span id="userNameNav">T√†i kho·∫£n</span> <i class="fas fa-chevron-down"></i>
                    </a>
                    <div class="dropdown-content">
                        <a href="#" onclick="showPage('profile')"><i class="fas fa-user"></i> Th√¥ng tin c√° nh√¢n</a>
                        <a href="#" onclick="showPage('orders')"><i class="fas fa-shopping-bag"></i> ƒê∆°n h√†ng c·ªßa t√¥i</a>
                        <a href="#" id="adminLink" onclick="showPage('admin')" style="display: none;"><i class="fas fa-cog"></i> Qu·∫£n tr·ªã</a>
                        <div class="dropdown-divider"></div>
                        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</a>
                    </div>
                </div>
            </div>
            
            <div class="nav-icons">
                <i class="fas fa-search"></i>
                <div class="cart-icon" onclick="showPage('cart')">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </div>
            </div>
            
            <div class="user-info" id="userInfo" style="display: none;">
                <span id="userName">Xin ch√†o, User!</span>
                <button onclick="logout()" class="btn-logout">ƒêƒÉng xu·∫•t</button>
            </div>
        </div>
    </header>

    <!-- Main Content Container -->
    <div id="mainContent">
        <!-- Home Page Content -->
        <div id="homePage" class="page-content" style="display: block;">
            <!-- Hero Section -->
            <section class="hero">
                <div class="hero-content">
                    <h1>Giao h√†ng si√™u t·ªëc b·∫±ng Drone</h1>
                    <p>Tr·∫£i nghi·ªám mua s·∫Øm m·ªõi v·ªõi c√¥ng ngh·ªá giao h√†ng drone hi·ªán ƒë·∫°i. Nhanh ch√≥ng, an to√†n v√† ti·ªán l·ª£i.</p>
                    <div class="hero-buttons">
                        <a href="#" class="btn-primary" onclick="showPage('products')">Mua s·∫Øm ngay</a>
                        <a href="#" class="btn-secondary" onclick="showPage('drones')">Xem Drone</a>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-drone hero-drone"></i>
                </div>
            </section>

            <!-- Features Section -->
            <section class="features">
                <div class="container">
                    <h2>T·∫°i sao ch·ªçn DroneShop?</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <i class="fas fa-rocket"></i>
                            <h3>Giao h√†ng si√™u t·ªëc</h3>
                            <p>Giao h√†ng trong v√≤ng 30 ph√∫t v·ªõi c√¥ng ngh·ªá drone hi·ªán ƒë·∫°i nh·∫•t</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-shield-alt"></i>
                            <h3>An to√†n tuy·ªát ƒë·ªëi</h3>
                            <p>H·ªá th·ªëng b·∫£o m·∫≠t v√† gi√°m s√°t 24/7 ƒë·∫£m b·∫£o h√†ng h√≥a an to√†n</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-map-marker-alt"></i>
                            <h3>Theo d√µi realtime</h3>
                            <p>Theo d√µi v·ªã tr√≠ ƒë∆°n h√†ng theo th·ªùi gian th·ª±c tr√™n b·∫£n ƒë·ªì</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Featured Products -->
            <section class="featured-products">
                <div class="container">
                    <h2>S·∫£n ph·∫©m n·ªïi b·∫≠t</h2>
                    <div class="products-grid" id="productGrid">
                        <!-- Products will be loaded here -->
                    </div>
                    <div class="view-all">
                        <a href="#" class="btn-primary" onclick="showPage('products')">Xem t·∫•t c·∫£ s·∫£n ph·∫©m</a>
                    </div>
                </div>
            </section>
        </div>

        <!-- Products Page Content -->
        <div id="productsPage" class="page-content" style="display: none;">
            <div class="compact-page-wrapper">
                <div class="compact-container">
                    <div class="compact-header">
                        <h1 class="compact-title">S·∫£n ph·∫©m</h1>
                        <p class="compact-subtitle">Danh m·ª•c s·∫£n ph·∫©m ƒëa d·∫°ng</p>
                    </div>
                    
                    <div class="compact-filters">
                        <button onclick="filterProducts('all')" class="compact-filter-btn active">T·∫•t c·∫£</button>
                        <button onclick="filterProducts('electronics')" class="compact-filter-btn">ƒêi·ªán t·ª≠</button>
                        <button onclick="filterProducts('accessories')" class="compact-filter-btn">Ph·ª• ki·ªán</button>
                        <button onclick="filterProducts('camera')" class="compact-filter-btn">Camera</button>
                    </div>
                    
                    <div class="compact-products-grid" id="allProductsGrid">
                        <!-- Products will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Drones Page Content -->
        <div id="dronesPage" class="page-content" style="display: none;">
            <div class="compact-page-wrapper">
                <div class="compact-container">
                    <div class="compact-header">
                        <h1 class="compact-title">ƒê·ªôi bay Drone</h1>
                        <p class="compact-subtitle">ƒê·ªôi bay drone hi·ªán ƒë·∫°i ph·ª•c v·ª• giao h√†ng</p>
                    </div>
                    
                    <div class="compact-drones-grid" id="dronesGrid">
                        <!-- Drones will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
                </div>
            </section>
        </div>

        <!-- Cart Page Content -->
        <div id="cartPage" class="page-content" style="display: none;">
            <section class="cart-section">
                <div class="container">
                    <h2>Gi·ªè h√†ng c·ªßa b·∫°n</h2>
                    <div class="cart-content">
                        <div class="cart-items" id="cartItems">
                            <!-- Cart items will be loaded here -->
                        </div>
                        <div class="cart-summary" id="cartSummary">
                            <h3>T·ªïng c·ªông</h3>
                            <div class="total-amount">
                                <span id="totalAmount">0 ‚Ç´</span>
                            </div>
                            <button class="btn-primary btn-checkout" onclick="proceedToCheckout()">
                                <i class="fas fa-credit-card"></i> Thanh to√°n
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Checkout Page Content -->
        <div id="checkoutPage" class="page-content" style="display: none;">
            <section class="checkout-section">
                <div class="container">
                    <h2>Thanh to√°n</h2>
                    <div class="checkout-content">
                        <div class="checkout-form">
                            <form id="checkoutForm" onsubmit="processCheckout(event)">
                                <div class="form-section">
                                    <h3>Th√¥ng tin kh√°ch h√†ng</h3>
                                    <div class="form-group">
                                        <label for="customerName">H·ªç v√† t√™n *</label>
                                        <input type="text" id="customerName" name="customerName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="customerPhone">S·ªë ƒëi·ªán tho·∫°i *</label>
                                        <input type="tel" id="customerPhone" name="customerPhone" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="customerEmail">Email</label>
                                        <input type="email" id="customerEmail" name="customerEmail">
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h3>Th√¥ng tin giao h√†ng</h3>
                                    <div class="form-group">
                                        <label for="deliveryAddress">ƒê·ªãa ch·ªâ giao h√†ng *</label>
                                        <input type="text" id="deliveryAddress" name="deliveryAddress" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="deliveryCity">T·ªânh/Th√†nh ph·ªë *</label>
                                        <select id="deliveryCity" name="deliveryCity" required>
                                            <option value="">Ch·ªçn t·ªânh/th√†nh ph·ªë</option>
                                            <option value="ho-chi-minh">TP. H·ªì Ch√≠ Minh</option>
                                            <option value="ha-noi">H√† N·ªôi</option>
                                            <option value="da-nang">ƒê√† N·∫µng</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="deliveryNotes">Ghi ch√∫ giao h√†ng</label>
                                        <textarea id="deliveryNotes" name="deliveryNotes" rows="3"></textarea>
                                    </div>
                                    
                                    <!-- Map for delivery location selection -->
                                    <div class="form-group">
                                        <label for="deliveryLocationMap">Ch·ªçn v·ªã tr√≠ giao h√†ng tr√™n b·∫£n ƒë·ªì *</label>
                                        <div class="delivery-location-container">
                                            <div class="delivery-coords-display">
                                                <div class="coords-info">
                                                    <span>üìç T·ªça ƒë·ªô: </span>
                                                    <span id="selectedCoords">Ch∆∞a ch·ªçn v·ªã tr√≠</span>
                                                    <button type="button" class="btn-clear-location" onclick="clearDeliveryLocation()" style="display: none;">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                                <div class="location-actions">
                                                    <button type="button" class="btn-secondary btn-use-current" onclick="useCurrentLocation()">
                                                        <i class="fas fa-location-arrow"></i> V·ªã tr√≠ hi·ªán t·∫°i
                                                    </button>
                                                    <button type="button" class="btn-secondary btn-search-address" onclick="searchAddressOnMap()">
                                                        <i class="fas fa-search"></i> T√¨m ƒë·ªãa ch·ªâ
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="delivery-map-container">
                                                <div id="deliveryLocationMap" style="height: 300px; width: 100%; border: 1px solid #ddd; border-radius: 8px;"></div>
                                            </div>
                                            <div class="map-instructions">
                                                <small><i class="fas fa-info-circle"></i> Click tr√™n b·∫£n ƒë·ªì ƒë·ªÉ ch·ªçn v·ªã tr√≠ giao h√†ng ch√≠nh x√°c. Drone s·∫Ω bay ƒë·∫øn ƒëi·ªÉm n√†y.</small>
                                            </div>
                                            <!-- Hidden inputs for coordinates -->
                                            <input type="hidden" id="deliveryLat" name="deliveryLat">
                                            <input type="hidden" id="deliveryLng" name="deliveryLng">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h3>Ph∆∞∆°ng th·ª©c thanh to√°n</h3>
                                    <div class="payment-methods">
                                        <label class="payment-method">
                                            <input type="radio" name="paymentMethod" value="cod" checked>
                                            <span class="payment-option">
                                                <i class="fas fa-money-bill-wave"></i>
                                                Thanh to√°n khi nh·∫≠n h√†ng (COD)
                                            </span>
                                        </label>
                                        <label class="payment-method">
                                            <input type="radio" name="paymentMethod" value="banking">
                                            <span class="payment-option">
                                                <i class="fas fa-university"></i>
                                                Chuy·ªÉn kho·∫£n ng√¢n h√†ng
                                            </span>
                                        </label>
                                        <label class="payment-method">
                                            <input type="radio" name="paymentMethod" value="momo">
                                            <span class="payment-option">
                                                <i class="fas fa-mobile-alt"></i>
                                                V√≠ MoMo
                                            </span>
                                        </label>
                                    </div>
                                </div>

                                <button type="submit" class="btn-primary btn-place-order">
                                    <i class="fas fa-check"></i> ƒê·∫∑t h√†ng
                                </button>
                            </form>
                        </div>

                        <div class="checkout-summary">
                            <h3>ƒê∆°n h√†ng c·ªßa b·∫°n</h3>
                            <div class="checkout-items" id="checkoutItems">
                                <!-- Checkout items will be loaded here -->
                            </div>
                            <div class="checkout-totals">
                                <div class="total-row">
                                    <span>T·∫°m t√≠nh:</span>
                                    <span id="subtotal">0 ‚Ç´</span>
                                </div>
                                <div class="total-row">
                                    <span>Ph√≠ giao h√†ng:</span>
                                    <span>Mi·ªÖn ph√≠</span>
                                </div>
                                <div class="total-row final-total">
                                    <span>T·ªïng c·ªông:</span>
                                    <span id="finalTotal">0 ‚Ç´</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Orders Page Content -->
        <div id="ordersPage" class="page-content" style="display: none;">
            <section class="orders-section">
                <div class="container">
                    <h2>ƒê∆°n h√†ng c·ªßa t√¥i</h2>
                    <div class="orders-list" id="ordersList">
                        <!-- Orders will be loaded here -->
                    </div>
                </div>
            </section>
        </div>

        <!-- Admin Page Content -->
        <div id="adminPage" class="page-content" style="display: none;">
            <section class="admin-section">
                <div class="container">
                    <div id="adminContent">
                        <!-- Admin content will be loaded here -->
                    </div>
                </div>
            </section>
        </div>

        <!-- Profile Page Content -->
        <div id="profilePage" class="page-content" style="display: none;">
            <section class="profile-section">
                <div class="container">
                    <h2>Th√¥ng tin c√° nh√¢n</h2>
                    <div id="profileContent">
                        <!-- Profile content will be loaded here -->
                    </div>
                </div>
            </section>
        </div>

        <!-- Order Processing Page -->
        <div id="order-processingPage" class="page-content" style="display: none; height: 100vh; overflow: hidden;">
            <div class="order-processing-layout" style="height: 100%; display: flex;">
                <!-- Sidebar -->
                <div class="order-sidebar" style="width: 350px; background: #f8f9fa; border-right: 1px solid #ddd; overflow-y: auto;">
                    <!-- Order Information -->
                    <div class="sidebar-section">
                        <h3><i class="fas fa-info-circle"></i> Th√¥ng tin ƒë∆°n h√†ng</h3>
                        <div id="orderInfoDetails">
                            <!-- Order details will be populated here -->
                        </div>
                    </div>

                    <!-- Drone Selection -->
                    <div class="sidebar-section">
                        <h3><i class="fas fa-drone"></i> Ch·ªçn Drone</h3>
                        <div id="droneSelectionList">
                            <!-- Drone list will be populated here -->
                        </div>
                    </div>

                    <!-- Flight Status -->
                    <div class="sidebar-section">
                        <h3><i class="fas fa-plane"></i> Tr·∫°ng th√°i bay</h3>
                        <div class="flight-status">
                            <div class="status-indicator idle" id="flightStatus">Ch·ªù kh·ªüi h√†nh</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="flightProgress" style="width: 0%"></div>
                            </div>
                            <div class="progress-text" id="progressText">0%</div>
                        </div>
                    </div>

                    <!-- Flight Controls -->
                    <div class="sidebar-section">
                        <h3><i class="fas fa-gamepad"></i> ƒêi·ªÅu khi·ªÉn bay</h3>
                        <div class="flight-controls">
                            <button class="btn btn-success start-btn" onclick="startFlight()" disabled>
                                <i class="fas fa-play"></i> Kh·ªüi h√†nh
                            </button>
                            <button class="btn btn-warning pause-btn" onclick="pauseFlight()" disabled>
                                <i class="fas fa-pause"></i> T·∫°m d·ª´ng
                            </button>
                            <button class="btn btn-info continue-btn" onclick="continueFlight()" disabled>
                                <i class="fas fa-play"></i> Ti·∫øp t·ª•c
                            </button>
                            <button class="btn btn-danger emergency-btn" onclick="emergencyLanding()" disabled>
                                <i class="fas fa-exclamation-triangle"></i> Kh·∫©n c·∫•p
                            </button>
                        </div>
                    </div>

                    <!-- Map Controls -->
                    <div class="sidebar-section">
                        <h3><i class="fas fa-map"></i> ƒêi·ªÅu khi·ªÉn b·∫£n ƒë·ªì</h3>
                        <div class="map-controls">
                            <button class="btn btn-primary map-btn" onclick="toggleRoutePlanning()">
                                <span id="planningBtnText"><i class="fas fa-route"></i> L·∫≠p l·∫°i l·ªô tr√¨nh</span>
                            </button>
                            <button class="btn btn-secondary map-btn" onclick="resetRoute()">
                                <i class="fas fa-undo"></i> ƒê·∫∑t l·∫°i
                            </button>
                            <button class="btn btn-success map-btn" onclick="optimizeRoute()" disabled>
                                <i class="fas fa-magic"></i> T·ªëi ∆∞u h√≥a
                            </button>
                        </div>
                        <div id="route-instructions" style="display: none;">
                            <p><small>Click tr√™n b·∫£n ƒë·ªì ƒë·ªÉ th√™m ƒëi·ªÉm d·ª´ng v√†o l·ªô tr√¨nh</small></p>
                        </div>
                    </div>

                    <!-- Completion -->
                    <div class="sidebar-section">
                        <button class="btn btn-success confirm-delivery-btn" onclick="confirmDeliveryFromPage()" disabled>
                            <i class="fas fa-check-circle"></i> Ch·ªù ho√†n th√†nh
                        </button>
                    </div>
                </div>

                <!-- Main Map Area -->
                <div class="order-main-content" style="flex: 1; position: relative;">
                    <div class="map-container-full" style="width: 100%; height: 100%;">
                        <div id="orderProcessingMap" style="width: 100%; height: 100%; min-height: 500px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ƒêƒÉng nh·∫≠p</h2>
                <span class="close" onclick="closeModal('loginModal')">&times;</span>
            </div>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginEmail">Email:</label>
                    <input type="email" id="loginEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">M·∫≠t kh·∫©u:</label>
                    <input type="password" id="loginPassword" name="password" required>
                </div>
                <button type="submit" class="btn-primary">ƒêƒÉng nh·∫≠p</button>
                <p class="demo-accounts">
                    <strong>T√†i kho·∫£n demo:</strong><br>
                    Admin: admin@demo.com / admin123<br>
                    User: user@demo.com / user123
                </p>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ƒêƒÉng k√Ω</h2>
                <span class="close" onclick="closeModal('registerModal')">&times;</span>
            </div>
            <form id="registerForm" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label for="registerName">H·ªç v√† t√™n:</label>
                    <input type="text" id="registerName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email:</label>
                    <input type="email" id="registerEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">M·∫≠t kh·∫©u:</label>
                    <input type="password" id="registerPassword" name="password" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u:</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                </div>
                <button type="submit" class="btn-primary">ƒêƒÉng k√Ω</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    
    <!-- Navigation Emergency Fix -->
    <script src="../../../navigation-fix.js"></script>
    
    <script src="../js/main.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/cart.js"></script>
    
    <script>
        // Initialize the application when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DOMContentLoaded triggered ===');
            console.log('Current page before init:', window.currentPage || 'undefined');
            
            // Force ensure we're on home page
            window.currentPage = 'home';
            
            // Initialize homepage immediately
            console.log('Calling showPage(home)');
            showPage('home');
            
            // Additional force show as backup
            setTimeout(() => {
                console.log('=== BACKUP FORCE SHOW ===');
                const heroSection = document.querySelector('.hero');
                const featuresSection = document.querySelector('.features'); 
                const featuredProductsSection = document.querySelector('.featured-products');
                
                if (heroSection) {
                    heroSection.style.display = 'flex';
                    heroSection.style.visibility = 'visible';
                    heroSection.style.opacity = '1';
                    console.log('BACKUP: Hero forced visible');
                }
                if (featuresSection) {
                    featuresSection.style.display = 'block';
                    featuresSection.style.visibility = 'visible'; 
                    featuresSection.style.opacity = '1';
                    console.log('BACKUP: Features forced visible');
                }
                if (featuredProductsSection) {
                    featuredProductsSection.style.display = 'block';
                    featuredProductsSection.style.visibility = 'visible';
                    featuredProductsSection.style.opacity = '1'; 
                    console.log('BACKUP: Featured products forced visible');
                }
            }, 500);
            
            // Force show homepage sections immediately as initial backup
            const heroSection = document.querySelector('.hero');
            const featuresSection = document.querySelector('.features');
            const featuredProductsSection = document.querySelector('.featured-products');
            
            if (heroSection) {
                heroSection.style.display = 'flex';
                heroSection.style.visibility = 'visible';
                heroSection.style.opacity = '1';
                console.log('Hero forced visible');
            }
            if (featuresSection) {
                featuresSection.style.display = 'block';
                featuresSection.style.visibility = 'visible';
                featuresSection.style.opacity = '1';
                console.log('Features forced visible');
            }
            if (featuredProductsSection) {
                featuredProductsSection.style.display = 'block';
                featuredProductsSection.style.visibility = 'visible';
                featuredProductsSection.style.opacity = '1';
                console.log('Featured products forced visible');
            }
            
            // Initialize functions if available
            try {
                if (typeof createDemoOrders === 'function') {
                    createDemoOrders();
                }
                
                if (typeof updateAuthUI === 'function') {
                    updateAuthUI();
                }
                
                if (typeof updateCartCount === 'function') {
                    updateCartCount();
                }
                
                // Show homepage first, this will handle all display logic
                if (typeof showPage === 'function') {
                    showPage('home');
                } else {
                    // Fallback if showPage not available yet
                    const homePage = document.getElementById('homePage');
                    if (homePage) {
                        homePage.style.display = 'block';
                        homePage.style.visibility = 'visible';
                        console.log('Homepage set to visible (fallback)');
                    }
                }
                
            } catch (error) {
                console.error('Error during initialization:', error);
                // Emergency fallback
                const homePage = document.getElementById('homePage');
                if (homePage) {
                    homePage.style.display = 'block';
                }
            }
            
            console.log('=== Initialization complete ===');
        });
    </script>
</body>
</html>